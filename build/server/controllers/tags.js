// Generated by CoffeeScript 1.8.0
var FavoriteTag, async;

async = require('async');

FavoriteTag = require('../models/favorite_tag');

module.exports.create = function(req, res) {
  var label;
  label = req.body.label;
  return FavoriteTag.ByLabelForTasky(label, function(err, tags) {
    if ((err != null) || (tags != null ? tags.length : void 0) > 0) {
      err = err || 'tag is already favorite';
      return res.send(500, err);
    } else {
      return FavoriteTag.create({
        label: label,
        application: 'tasky'
      }, function() {
        return res.send(201);
      });
    }
  });
};

module.exports["delete"] = function(req, res) {
  var label;
  label = req.body.label;
  return FavoriteTag.ByLabelForTasky(label, function(err, tags) {
    if ((err != null) || (tags != null ? tags.length : void 0) === 0) {
      err = err || 'tag is not favorite';
      return res.send(500, err);
    } else {
      return async.eachSeries(tags, function(tag, done) {
        return tag.destroy(done);
      }, function() {
        return res.send(204);
      });
    }
  });
};
